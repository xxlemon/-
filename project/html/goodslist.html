<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../css/goodslist.css">
    <link rel="stylesheet" href="../css/public.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_1332972_q4bcpfqo4k.css">
    <style>
    #car{
    width:200px;
    height:50px;
	margin:20px auto;
	background:green;
    color:#fff;
    font:20px/50px "";
    text-align: center;
    border: none;

}
#car a{
    color:rgb(223, 22, 22);
}
    </style>
    
</head>
<body>
        <header>	
                <div class="top">
                    <div class="margin">
                        <div class="left">
                            <a href="../html/login.html">请登录</a>
                            <span>|</span>
                            <a href="../html/register.html">免费注册</a>
                        </div>
                        <div class="right">
                            <a href="#">我的订单</a>
                            <a href="#">我的鲜果</a>
                            <a href="#"><i class="iconfont icon-fuwu-"></i>在线服务</a>
                            <a href="#">积分商城</a>
                            <a href="#"><i class="iconfont icon-zuobiao3"></i>网站地图</a>
                        </div>
                    </div>	
                </div>
                
                <div class="center margin">
                    <img src="../images/logo.gif" class="logo">
                    <div class="search">
                        <form>
                            <input class="txt" value="" />
                            <input type="submit" class="sub" value="搜索" />
                        </form>
                        <p>
                            <span>热搜:</span>
                            <a href="#">葡萄</a>
                            <a href="#">哈密瓜</a>
                            <a href="#">青芒</a>
                            <a href="#">榴莲</a>
                            <a href="#">火龙果</a>
                            <a href="#">香蕉</a>
                            <a href="#">蜜桃</a>
                        </p>
                    </div>
                    
                    <!-- <a href="car.html" class="shop bg"><i class="iconfont icon-gouwuchekong"></i>购物车<span>0</span>件</a> -->
                    
                </div>
                
            </header>
            <nav>
                <div class="margin">
                    <div class="nav-l">
                        <h3>商品类型</h3>
            
                    </div>
                    <div class="nav-c">
            
                        <ul>
                            <li><a href="../html/frist.html">首页</a></li>
                            <li><a href="#">精选水果</a></li>
                            <li><a href="#">精选水果</a></li>
                            <li><a href="#">精选水果</a></li>
                            <li><a href="#">精选水果</a></li>
                            <li><a href="#">精选水果</a></li>
                            <li><a href="#">精选水果</a></li>
                        </ul>
                    </div>
            
                </div>
            
            </nav>

    <div class="list margin">
        <p>精品水果</p>
        <div class="goodstable">
            <ul>
                <li>
                    <a herf="#">品牌</a>
                    <a href="#">香蕉</a>
                   
                    <a href="detail.html">火龙果</a>
                   
                    <a href="#">水蜜桃</a>
                    
                    <a href="#">柚子</a>
                    
                    <a href="#">芒果</a>
                </li>
                <li>
                    <a herf="#"></a>
                    <a href="#">香蕉</a>
                    
                    <a href="detail.html">火龙果</a>
                    
                    <a href="#">水蜜桃</a>
                    
                    <a href="#">柚子</a>
                    
                    <a href="#">芒果</a>
                </li>
            
            </ul>
            <ul class="bottom">
                <li>
                        <a herf="#">销量</a>
                        <a href="#">数量</a>
                        
                        <a href="#">价格</a>
                        
                        
                </li>
                <li class="card">
                    <span>库存</span>
                    <span>地址</span>
                        <select>
                            <options>上海</options>
                            <options>上海</options>
                        </select>

                   
                    <span>显示有货</span>
                    <input type="checkbox" class="ck">
                    <span>有优惠</span>
                    <input type="checkbox" class="ck">
                </li>
            </ul>

        </div>
        
    </div>

    <div class="cont">
        <!-- <p>当前商品已卖完，请稍候再来......</p> -->
        <!-- <div class="box">
            <img src="images/1.jpg" alt="">
            <span>商品1</span>
            <p>23.99</p>
            <em>好用1</em>
            <i>加入购物车</i>
        </div> -->
    </div>

    <h3 id="car">去<a href="car.html">购物车</a>结算</h3>
    
    <footer>
            <div class="guide margin">
                <div class="left">
                    <img src="../images/logo.gif" class="logo">
                    <em>热线电话：8888888</em>
                    <span>周一到周日  9：00-20：00</span>
                </div>
            
                <div class="center">
                    <ul>
                        <li class="frist">购物指南</li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                    </ul>
                    <ul>
                        <li class="frist">购物指南</li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                    </ul>
                    <ul>
                        <li class="frist">购物指南</li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                    </ul>
                    <ul>
                        <li class="frist">购物指南</li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                        <li><a href="#">购物流程</a></li>
                    </ul>
                </div>
                
                <div class="right">
                    <div class="sbox"
                    <p>手机客户端</p>
                    <img src="../images/1.png">
                    </div>
                    <div class="sbox">
                    <p>官方微信</p>
                    <img src="../images/17.png">
                    </div>
                </div>
            </div>
            
            <div class="bottom">
                <div class="bbox margin">
                    <div class="left">
                        <a href="#">用户协议</a>
                        <span>|</span>
                        <a href="#">隐私协议</a>
                        <span>|</span>
                        <a href="#">营业资质</a>
                        <span>|</span>
                        <a href="#">诚信举报</a>
                        <span>|</span>
                        <a href="#">关于我们</a>
                        <span>|</span>
                        <a href="#">联系我们</a>
                        
                        <img src="../images/6.gif">	
                    </div>
                    
                    <div class="right">
                        <p class="frist">Copyright © 2005-2019上海易果电子商务有限公司版权所有</p>
                        <p>沪ICP备09008015号    沪公网安备 31010502000002号</p>
                        <img src="../images/7.gif">	
                    </div>
                </div>
            </div>
            
        </footer>
</body>
<script src="../js/ajax.js"></script>
<script src="../js/cookie.js"></script>
<script>
    class List{
        constructor(){
            this.cont = document.querySelector(".cont");
            this.url = "http://localhost/project/json/goodsList.json";

            this.load();
            // 1.绑定事件
            this.addEvent();
        }
        addEvent(){
            var that = this;
            // 利用事件委托找到按钮
            this.cont.addEventListener("click",function(eve){
                if(eve.target.className == "btn"){
                    // 存cookie，存什么？2.唯一的信息，商品的货号
                    that.id = eve.target.parentNode.getAttribute("qwe");
                    // 3.存cookie了
                    that.setCookie();
                }
            })
        }
        setCookie(){
            // console.log(this.id)
            // S1.规划数据的格式
            // 同一个商品点击多次
            // {id:this.id,num:4}
            // 不同的商品点击多次
            // 只有一条cookie，保存了所有商品
            // [{id:this.id,num:2},{id:this.id,num:4},....]
            // S2.第一次存和之后存,只有一条cookie
            // 先读取
            this.goods = getCookie("goods") ? JSON.parse(getCookie("goods")) : [];
            if(this.goods.length == 0){
                // 第一次:直接写数组,数组中放一个对象
                this.goods.push({
                    id:this.id,
                    num:1
                })
            }else{
                // 之后存:新商品和老商品
                // 先遍历,比较
                var i = 0;
                var onoff = this.goods.some((val,index)=>{
                    i = index;
                    return val.id == this.id;
                })
                if(onoff){
                    // 老商品:
                    // 修改对应对象的num属性
                    this.goods[i].num++
                }else{
                    // 新商品:
                    // 增加对象
                    this.goods.push({
                        id:this.id,
                        num:1
                    })
                }
            }
            // 再设置
            setCookie("goods",JSON.stringify(this.goods));
        }
        load(){
            var that = this;
            ajaxGet(this.url,function(res){
                that.res = JSON.parse(res);
                that.display();
            })
        }
        display(){
            // console.log(this.res);
            var str = "";
            this.res.forEach((val)=>{
                str += `<div class="box" qwe="${val.goodsId}">
                            
                            <img src="${val.goodsImg}" alt="">
                            <span>${val.items}</span>
                            <p>${val.price}</p>
                            <em>${val.goodName}</em>
                            <i class="btn">加入购物车</i>
                        </div>`
            })
            this.cont.innerHTML = str;
        }
    }

    new List;
</script>
</html>